!***********************************************************************
!                        Version 1:  08/94, PFN                        *
!                                                                      *
!   QUADSLAB - Calculates group dependent quadrature sets for Sn       *
!              radiation transport in slab geometry.                   *
!                                                                      *
!   Input:   nordr  - vector of group quadrature orders (no st. dir.)  *
!            nangt  - sum of quadrature orders for all groups (w/st d) *
!            ngr    - number of frequency groups                       *
!                                                                      *
!   Output:  OMEGA  - group dependent direction cosines (mu)           *
!            QUADWT - group dependent quadrature weights               *
!                                                                      *
!   Allowed values of "n" are:  2, 4, 6, 8, 10, 12, 16, 20, 32         *
!                                                                      *
!***********************************************************************

   subroutine quadslab(self)

   use kind_mod
   use Quadrature_mod

   implicit none

!  Arguments

   type(Quadrature) :: self

!  Local

   integer    :: i,nangl,ns,nf,norder

   integer    :: iang(32)

   real(adqt) :: amu(55),wgt(55)

!  Constants
 
   data amu/.577350269189626d0,                                       &
            .861136311594053d0,.339981043584856d0,.932469514203152d0, &
            .661209386466265d0,.238619186083197d0,.960289856497536d0, &
            .796666477413627d0,.525532409916329d0,.183434642495650d0, &
            .973906528517172d0,.865063366688985d0,.679409568299024d0, &
            .433395394129247d0,.148874338981631d0,.981560634246719d0, &
            .904117256370475d0,.769902674194305d0,.587317954286617d0, &
            .367831498998180d0,.125233408511469d0,.989400934991649d0, &
            .944575023073232d0,.865631202387831d0,.755404408355003d0, &
            .617876244402643d0,.458016777657227d0,.281603550779258d0, &
            .095012509837637d0,.993128599185094d0,.963971927277913d0, &
            .912234428251325d0,.839116971822218d0,.746331906460150d0, &
            .636053680726515d0,.510867001950827d0,.373706088715419d0, &
            .227785851141645d0,.076526521133497d0,.997263861849481d0, &
            .985611511545268d0,.964762255587506d0,.934906075937739d0, &
            .896321155766052d0,.849367613732569d0,.794483795967942d0, &
            .732182118740289d0,.663044266930215d0,.587715757240762d0, &
            .506899908932229d0,.421351276130635d0,.331868602282127d0, &
            .239287362252137d0,.144471961582796d0,.048307665687738d0/
 
   data wgt/1.d0,                                                     &
            .347854845137454d0,.652145154862546d0,.171324492379170d0, &
            .360761573048139d0,.467913934572691d0,.101228536290376d0, &
            .222381034453374d0,.313706645877887d0,.362683783378362d0, &
            .066671344308688d0,.149451349150581d0,.219086362515982d0, &
            .269266719309996d0,.295524224714753d0,.047175336386512d0, &
            .106939325995318d0,.160078328543346d0,.203167426723066d0, &
            .233492536538355d0,.249147045813403d0,.027152459411754d0, &
            .062253523938647d0,.095158511682492d0,.124628971255533d0, &
            .149595988816576d0,.169156519395002d0,.182603415044923d0, &
            .189450610455068d0,.017614007139152d0,.040601429800386d0, &
            .062672048334109d0,.083276741576704d0,.101930119817240d0, &
            .118194531961518d0,.131688638449176d0,.142096109318382d0, &
            .149172986472603d0,.152753387130725d0,.007018610009470d0, &
            .016274394730905d0,.025392065309262d0,.034273862913021d0, &
            .042835898022226d0,.050998059262376d0,.058684093478535d0, &
            .065822222776361d0,.072345794108848d0,.078193895787070d0, &
            .083311924226946d0,.087652093004403d0,.091173878695763d0, &
            .093844399080804d0,.095638720079274d0,.096540088514727d0/
 
!  Angular weights sum to 2 for all mu
 
   iang(2)  = 1
   iang(4)  = 2
   iang(6)  = 4
   iang(8)  = 7
   iang(10) = 11
   iang(12) = 16
   iang(16) = 22
   iang(20) = 30
   iang(32) = 40
 
!  Set direction cosines and weights
 
   norder = self% order
   nangl  = norder/2
   ns     = iang(norder)
   nf     = ns + nangl - 1
 
!  MU < 0
 
   do i=ns,nf
      self% omega(1,1+i-ns) = -amu(i)
     self% weight(1+i-ns)   =  wgt(i)
   enddo
 
!  MU > 0
 
   do i=nangl,1,-1
      self% omega(1,1+norder-i) =  -self% omega(1,i)
     self% weight(1+norder-i)   =  self% weight(i)
   enddo
 
 
   return
   end subroutine quadslab

